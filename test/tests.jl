using KCores
using Graphs
using Base.Test
v = collect(0:20)
edgs = Array{Int,1}[[4,7],[4,9],[6,12],[3,19],[3,5],[9,12],[6,7],[10,19],[7,13],[0,9],[4,13],[7,14],[14,15],[1,13],[0,13],[10,15],[16,19],[1,16],[6,8],[7,15],[1,3],[6,14],[0,10],[9,10],[5,18],[5,16],[2,5],[0,12],[13,15],[8,16],[5,8],[2,14],[14,20],[3,17],[2,19],[0,14],[1,19],[3,7],[19,20],[4,18],[12,15],[2,13],[1,8],[0,19],[1,11],[4,12],[10,14],[3,4],[4,11],[6,15],[11,16],[12,14],[3,13],[10,17],[15,17],[6,11],[7,17],[2,20],[1,9],[9,18],[0,3],[1,2],[7,9],[3,16],[5,12],[1,20],[17,20],[11,15],[0,1],[16,18],[2,17],[15,18],[12,19],[5,20],[7,18],[2,16],[9,20],[9,15],[8,11],[1,10],[0,11],[15,19],[0,4],[1,4],[17,18],[6,19],[11,18],[13,17],[4,14],[1,14],[14,19],[1,12],[8,10],[2,7],[5,14],[5,6],[2,15],[3,18],[0,17],[7,12]]
g = graph(Int64[],Graphs.ExEdge{Int64}[],is_directed = false)
for vert in v
  add_vertex!(g,vert)
end
i = 0
for edg in edgs
    Graphs.add_edge!(g,Graphs.ExEdge(i,edg[1],edg[2]))
  i+=1
end
e_arr =  Array{Int,1}[]
@test core_number(g) == Dict{Int,Int}([(18,7),(2,7),(16,7),(11,7),(0,7),(7,7),(9,7),(10,7),(19,7),(17,7),(8,6),(6,7),(4,7),(3,7),(5,7),(20,7),(13,7),(14,7),(15,7),(12,7),(1,7)])
@test vertices(k_core(g)) == [18,2,16,11,0,7,9,10,19,17,6,4,3,5,20,13,14,15,12,1]
edgs = edges(k_core(g))
for e in edgs
  push!(e_arr,[e.source,e.target])
end
@test e_arr == Array{Int,1}[[4,7],[4,9],[6,12],[3,19],[3,5],[9,12],[6,7],[10,19],[7,13],[0,9],[4,13],[7,14],[14,15],[1,13],[0,13],[10,15],[16,19],[1,16],[7,15],[1,3],[6,14],[0,10],[9,10],[5,18],[5,16],[2,5],[0,12],[13,15],[2,14],[14,20],[3,17],[2,19],[0,14],[1,19],[3,7],[19,20],[4,18],[12,15],[2,13],[0,19],[1,11],[4,12],[10,14],[3,4],[4,11],[6,15],[11,16],[12,14],[3,13],[10,17],[15,17],[6,11],[7,17],[2,20],[1,9],[9,18],[0,3],[1,2],[7,9],[3,16],[5,12],[1,20],[17,20],[11,15],[0,1],[16,18],[2,17],[15,18],[12,19],[5,20],[7,18],[2,16],[9,20],[9,15],[1,10],[0,11],[15,19],[0,4],[1,4],[17,18],[6,19],[11,18],[13,17],[4,14],[1,14],[14,19],[1,12],[2,7],[5,14],[5,6],[2,15],[3,18],[0,17],[7,12]]
@test vertices(k_shell(g)) == [18,2,16,11,0,7,9,10,19,17,6,4,3,5,20,13,14,15,12,1]
e_arr =  Array{Int,1}[]
edgs = edges(k_shell(g))
for e in edgs
  push!(e_arr,[e.source,e.target])
end
@test e_arr == Array{Int,1}[[4,7],[4,9],[6,12],[3,19],[3,5],[9,12],[6,7],[10,19],[7,13],[0,9],[4,13],[7,14],[14,15],[1,13],[0,13],[10,15],[16,19],[1,16],[7,15],[1,3],[6,14],[0,10],[9,10],[5,18],[5,16],[2,5],[0,12],[13,15],[2,14],[14,20],[3,17],[2,19],[0,14],[1,19],[3,7],[19,20],[4,18],[12,15],[2,13],[0,19],[1,11],[4,12],[10,14],[3,4],[4,11],[6,15],[11,16],[12,14],[3,13],[10,17],[15,17],[6,11],[7,17],[2,20],[1,9],[9,18],[0,3],[1,2],[7,9],[3,16],[5,12],[1,20],[17,20],[11,15],[0,1],[16,18],[2,17],[15,18],[12,19],[5,20],[7,18],[2,16],[9,20],[9,15],[1,10],[0,11],[15,19],[0,4],[1,4],[17,18],[6,19],[11,18],[13,17],[4,14],[1,14],[14,19],[1,12],[2,7],[5,14],[5,6],[2,15],[3,18],[0,17],[7,12]]
@test vertices(k_crust(g)) == [8]
@test vertices(k_corona(g)) == [16,11,10,6,20]
edgs = edges(k_corona(g))
e_arr =  Array{Int,1}[]
for e in edgs
  push!(e_arr,[e.source,e.target])
end
#println(e_arr)
@test e_arr == Array{Int,1}[[11,16],[6,11]]
